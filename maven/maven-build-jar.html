<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Angilin的博客 - Angilin.GitHub.io by angilin</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="../stylesheets/normalize.css" media="screen">
    <link rel="stylesheet" type="text/css" href="../stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="../stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Angilin的博客 - Angilin.GitHub.io</h1>
      <h2 class="project-tagline">Angilin的博客</h2>
    </section>

    <section class="main-content">
<h1>jar打包和运行</h1>
<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div><b>如何生成一个可运行jar</b></div><div>主要依靠jar包内目录META-INF下的MANIFEST.MF文件</div><div>Manifest-Version: 1.0</div><div>Built-By: XXXXXX</div><div>Build-Jdk: 1.7.0_51</div><div>Class-Path:     所有依赖的jar的路径</div><div>Main-Class:    启动类，需要有main方法</div><div>Created-By: Maven Integration for Eclipse</div><div><br/></div><div>可以通过配置pom.xml来生成该文件，maven配置见<a href="#maven-jar">maven打包jar</a></div><div>maven有one-jar工具，可以把lib和项目打成一个jar包</div><div><br/></div><div><br/></div><div><br/></div><div><b>如何运行一个jar</b></div><div>java -jar XXX.jar</div><div>如果要带上JVM参数，需要加在java和-jar之间，如java -Xmx256m -Dglobal.config.path=&quot;/home/test/config/&quot; -jar &quot;abc.jar&quot;</div><div>如果要带上传给main方法的参数，直接跟后面就可以 java -jar HelloWorld.jar 123</div><div>public class HelloWorld{</div><div>public static void main(String[] args){</div><div>System.out.println(arg[0]);</div><div>}</div><div>}</div><div><br/></div><b>在linux上运行jar</b><div>nohup java -Dglobal.config.path=&quot;/home/test/config/&quot; -jar test-service-startup-0.0.1.jar &amp;</div><div>注意 nohup运行后，如果没有执行完就关闭窗口，可能会导致启动失败</div><div>需要在运行后按一下ctrl+c          可能原因是nohup打印日志在没有执行/启动完之前还是会和启动进程相关</div><div><br/></div><div>nohup ... &amp;</div><div>后台运行，会在当前目录下生成一个nohup.out日志文件</div><div>如果运行该命令时进入了日志文本输出状态，需要在退出日志文本输出状态后退出连接终端，否则也会导致退出连接终端后该线程终止的情况</div><div>参考http://www.cnblogs.com/allenblogs/archive/2011/05/19/2051136.html</div><div><br/></div><div>如果不希望看到这么长的命令，可以写sh和bat脚本</div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><a name="maven-jar"><b>maven打包jar</b></a></div><div>mainClass为jar运行时的主类，这种打包方式是把所有依赖lib包都移动到和jar包同级的lib文件夹下，再通过one-jar插件打成一个包</div><div>&lt;build&gt;</div><div>                 &lt;plugins &gt;</div><div>                      &lt;!-- 打包源码，给外部调用程序看源码 --&gt;</div><div>                      &lt;plugin &gt;</div><div>                           &lt;artifactId &gt;maven-source-plugin&lt;/artifactId &gt;</div><div>                            &lt;version &gt;0.0.1 &lt;/version &gt;</div><div>                            &lt;configuration &gt;</div><div>                                 &lt;attach &gt;true &lt;/attach &gt;</div><div>                            &lt;/configuration &gt;</div><div>                            &lt;!-- &lt;executions&gt; &lt;execution&gt; &lt;phase&gt;compile&lt;/phase&gt; &lt;goals&gt; &lt;goal&gt;jar&lt;/goal&gt;</div><div>                                &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; --&gt;</div><div>                      &lt;/plugin &gt;</div><div>                      &lt;!-- 设置编译 --&gt;</div><div>                      &lt;plugin &gt;</div><div>                           &lt;groupId &gt;org.apache.maven.plugins &lt;/groupId &gt;</div><div>                           &lt;artifactId &gt;maven-compiler-plugin&lt;/artifactId &gt;</div><div>                            &lt;version &gt;2.5 &lt;/version &gt;</div><div>                            &lt;configuration &gt;</div><div>                                 &lt;source &gt;1.7 &lt;/source &gt;</div><div>                                 &lt;target &gt;1.7 &lt;/target &gt;</div><div>                                 &lt;!-- 测试用例不验证 --&gt;</div><div>                                 &lt;skip &gt;true &lt;/skip &gt;</div><div>                                 &lt;encoding &gt;UTF-8 &lt;/encoding &gt;</div><div>                            &lt;/configuration &gt;</div><div>                      &lt;/plugin &gt;</div><div>                      &lt;plugin &gt;</div><div>                           &lt;groupId &gt;org.apache.maven.plugins &lt;/groupId &gt;</div><div>                           &lt;artifactId &gt;maven-dependency-plugin&lt;/artifactId &gt;</div><div>                            &lt;executions &gt;</div><div>                                 &lt;execution&gt;</div><div>                                      &lt;id &gt;copy &lt;/id &gt;</div><div>                                      &lt;phase &gt;install &lt;/phase &gt;</div><div>                                      &lt;goals &gt;</div><div>                                           &lt;goal &gt;copy-dependencies &lt;/goal &gt;</div><div>                                      &lt;/goals &gt;</div><div>                                      &lt;configuration &gt;</div><div>                                           &lt;outputDirectory &gt;target/lib &lt;/outputDirectory &gt;&lt;!-- 提取项目中使用全部jar --&gt;</div><div>                                      &lt;/configuration &gt;</div><div>                                 &lt;/execution &gt;</div><div>     </div><div>                            &lt;/executions &gt;</div><div>                      &lt;/plugin &gt;</div><div>                      &lt;plugin &gt;</div><div>                           &lt;groupId &gt;org.apache.maven.plugins &lt;/groupId &gt;</div><div>                           &lt;artifactId &gt;maven-jar-plugin&lt;/artifactId &gt;</div><div>                            &lt;configuration &gt;</div><div>                                 &lt;archive &gt;</div><div>                                      &lt;manifest &gt;</div><div>                                           &lt;addClasspath &gt;true &lt;/addClasspath &gt;</div><div>                                           &lt;classpathPrefix &gt;lib/ &lt;/classpathPrefix &gt;&lt;!-- 加载项目引用的jar --&gt;</div><div>                                           &lt;mainClass &gt;com.xxx.startup.Bootstrap &lt;/mainClass &gt;</div><div>                                      &lt;/manifest &gt;</div><div>                                 &lt;/archive &gt;</div><div>                            &lt;/configuration &gt;</div><div>                      &lt;/plugin &gt;</div><div>                      &lt;plugin&gt;</div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>    &lt;groupId&gt;com.jolira&lt;/groupId&gt;</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>    &lt;artifactId&gt;onejar-maven-plugin&lt;/artifactId&gt;</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>    &lt;version&gt;1.4.4&lt;/version&gt;</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>    &lt;executions&gt;</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>        &lt;execution&gt;</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>            &lt;configuration&gt;</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>                &lt;attachToBuild&gt;true&lt;/attachToBuild&gt;</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>                &lt;classifier&gt;onejar&lt;/classifier&gt;</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>            &lt;/configuration&gt;</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>            &lt;goals&gt;</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>                &lt;goal&gt;one-jar&lt;/goal&gt;</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>            &lt;/goals&gt;</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>        &lt;/execution&gt;</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>    &lt;/executions&gt;</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&lt;/plugin&gt;   </div></blockquote></blockquote><div>                 &lt;/plugins &gt;</div><div>     &lt;/build &gt;</div><div><br/></div><div align="left"><font color="#008080" face="Consolas" size="4"><br/></font></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></div>
</div>
  </body>
</html>
